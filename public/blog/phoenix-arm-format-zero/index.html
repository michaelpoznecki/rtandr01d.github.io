<!doctype html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title> // My Blog</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.126.3">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.5b1fcc8902588589c4767187402a3c29f8b8d7a6fdef6d9f8f77045bb0d14fee.css" />
    

    
  


    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="My Blog">
  <meta name="twitter:description" content="&lt;!DOCTYPE html&gt; Phoenix ARM Format Zero Andr01ds Blog Phoenix ARM Format Zero June 19, 2023 Now that I have rounded off the stack challenges, now I will move on to the Format Strings challenges. Format Strings is a vulnerability where the input of the user is not santizied for special characters correctly, allowing the input to be a “format” string telling the program what kind of string should be returned. This can create situations where the user can read or modify memory.">

    <meta property="og:url" content="http://localhost:1313/blog/phoenix-arm-format-zero/">
  <meta property="og:site_name" content="My Blog">
  <meta property="og:title" content="My Blog">
  <meta property="og:description" content="&lt;!DOCTYPE html&gt; Phoenix ARM Format Zero Andr01ds Blog Phoenix ARM Format Zero June 19, 2023 Now that I have rounded off the stack challenges, now I will move on to the Format Strings challenges. Format Strings is a vulnerability where the input of the user is not santizied for special characters correctly, allowing the input to be a “format” string telling the program what kind of string should be returned. This can create situations where the user can read or modify memory.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">


  </head>
  <body>
    <header class="app-header">
      <a href="http://localhost:1313/"><img class="app-header-avatar" src="/avatar.jpg" alt="John Doe" /></a>
      <span class="app-header-title">My Blog</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/blog/">Blog</a>
      </nav>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc vehicula turpis sit amet elit pretium.</p>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title"></h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jan 1, 0001
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Just a standard blog">
    
    <link rel="shortcut icon" href="https://rtandr01d.net/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.min.css">

    <link rel="canonical" href="https://rtandr01d.net/posts/phoenix-arm-format-zero/" />
    <title>Phoenix ARM Format Zero</title>
</head>
<body><header id="banner">
    <h2><a href="https://rtandr01d.net">Andr01ds Blog</a></h2>
    <nav>
        <ul>
            
        </ul>
    </nav>
</header>
<main id="content">
<article>
    <header id="post-header">
        <h1>Phoenix ARM Format Zero</h1>
        <div>
                <time>June 19, 2023</time>
            </div>
    </header><p>Now that I have rounded off the stack challenges, now I will move on to the Format Strings challenges. Format Strings is a vulnerability where the input of the user is not santizied for special characters correctly, allowing the input to be a &ldquo;format&rdquo; string telling the program what kind of string should be returned. This can create situations where the user can read or modify memory.</p>
<p>In the first challenge, the objective is simply to change a variable which the user does not have direct control over. Taking a look at the source code, we can see there is an &lsquo;sprintf&rsquo; call which attempts to print the contents of buffer into locals.dest.</p>
<p><img src="/posts/images/formatzerosource.png" alt="img"></p>
<p>Within the locals struct, we can see the char buffer dest and integer changeme. We want to overwrite changeme, and we have 32 characters to fill the dest buffer with before we can do this. However, our input buffer is only 16 characters long. How can we overcome this?</p>
<p>As I mentioned before, a format strings vulnerability allows for us to tell the program what format of input we are trying to supply. Due to this issue, we can provide input which, when interpreted by the machine, will fill the dest buffer (during the sprintf) with information of the size we are providing.</p>
<p>In this example, I decided to use the &ldquo;%x&rdquo; format. I can only provide up to 16 of these, however each %x will fill 8 bytes of the dest buffer, thus providing the overflow to change the changeme variable.</p>
<p><img src="/posts/images/formatzerosuccess.png" alt="img"></p>
<p>Success.</p>
</article>

        </main><footer id="footer">
    @andr01d@defcon.social
</footer>
</body>
</html>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
