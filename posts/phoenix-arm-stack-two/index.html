<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Just a standard blog">
    
    <link rel="shortcut icon" href="https://rtandr01d.net/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.min.css">

    <link rel="canonical" href="https://rtandr01d.net/posts/phoenix-arm-stack-two/" />
    <title>Phoenix ARM Stack Two</title>
</head>
<body><header id="banner">
    <h2><a href="https://rtandr01d.net">Andr01ds Blog</a></h2>
    <nav>
        <ul>
            
        </ul>
    </nav>
</header>
<main id="content">
<article>
    <header id="post-header">
        <h1>Phoenix ARM Stack Two</h1>
        <div>
                <time>April 26, 2023</time>
            </div>
    </header><h1 id="stack-two">Stack Two</h1>
<p>Stack two is similar to the stack one, however this binary will take a environment variable as the string. If we take a look at the source code, we can see there is a check for the environment variable before copying the string in environment variable over, meaning we cannot continue with the exploit without atleast setting the variable.</p>
<p><img src="/posts/images/stacktwosource.png" alt="img"></p>
<p>We can also see this in the branch instruction to getenv within the main function:</p>
<p><img src="/posts/images/as_getenv.png" alt="img"></p>
<p>Next the program checks for a hex value <code>0x0d0a090a</code> in the <code>changeme</code> variable. Once again we can overflow our 64 byte buffer and include the value at the end of the buffer to complete this level.</p>
<p><img src="/posts/images/stacktwoexploit.png" alt="img"></p>
<p><img src="/posts/images/stacktwosuccess.png" alt="img"></p>
</article>

        </main><footer id="footer">
    @andr01d@defcon.social
</footer>
</body>
</html>
